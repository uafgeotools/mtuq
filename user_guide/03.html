<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Acquiring Green’s functions &#8212; MTUQ Documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data processing" href="04.html" />
    <link rel="prev" title="Acquiring seismic data" href="02.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          MTUQ</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick start</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01.html">Learning Python and ObsPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="02.html">Acquiring seismic data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Acquiring Green’s functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.html">Data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="05.html">Visualization galleries</a></li>
<li class="toctree-l1"><a class="reference internal" href="06.html">Additional topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">Library reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Acquiring Green’s functions</a><ul>
<li><a class="reference internal" href="#role-of-green-s-functions">Role of Green’s functions</a></li>
<li><a class="reference internal" href="#greenstensor-objects"><cite>GreensTensor</cite> objects</a></li>
<li><a class="reference internal" href="#green-s-function-conventions">Green’s function conventions</a></li>
<li><a class="reference internal" href="#downloading-precomputed-green-s-functions">Downloading precomputed Green’s functions</a></li>
<li><a class="reference internal" href="#computing-green-s-functions-from-1d-earth-models">Computing Green’s functions from 1D Earth models</a></li>
<li><a class="reference internal" href="#computing-green-s-functions-from-3d-earth-models">Computing Green’s functions from 3D Earth models</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="02.html" title="Previous Chapter: Acquiring seismic data"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Acquiring sei...</span>
    </a>
  </li>
  <li>
    <a href="04.html" title="Next Chapter: Data processing"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Data processing &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="acquiring-green-s-functions">
<h1>Acquiring Green’s functions<a class="headerlink" href="#acquiring-green-s-functions" title="Permalink to this headline">¶</a></h1>
<p>The response of a medium to an impulsive source is called a Green’s function.  This page describes the role of Green’s functions in source inversions, the types of Green’s functions supported by MTUQ, and how these different types can each be obtained.</p>
<section id="role-of-green-s-functions">
<h2>Role of Green’s functions<a class="headerlink" href="#role-of-green-s-functions" title="Permalink to this headline">¶</a></h2>
<p>By combining Green’s functions, it is possible to obtain synthetics from any moment tensor or force source.  Generating synthetics in this way is useful because it provides cost savings compared with on-the-fly wavefield simulations. Synthetics can then be compared with data to determine a best-fitting source.</p>
</section>
<section id="greenstensor-objects">
<h2><cite>GreensTensor</cite> objects<a class="headerlink" href="#greenstensor-objects" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://uafgeotools.github.io/mtuq/library/generated/mtuq.GreensTensor.html">GreensTensor</a> objects provide access to a set of Green’s functions describing the medium response between a given hypocenter and station.</p>
<p>Methods built into the <cite>GreensTensor</cite> class allow data processing and synthetics generation.  In particular, the <a class="reference external" href="https://uafgeotools.github.io/mtuq/library/generated/mtuq.GreensTensor.get_synthetics.html#mtuq.GreensTensor.get_synthetics">get_synthetics</a> method accepts a <cite>MomentTensor</cite> or <cite>Force</cite> and returns corresponding synthetics.</p>
</section>
<section id="green-s-function-conventions">
<h2>Green’s function conventions<a class="headerlink" href="#green-s-function-conventions" title="Permalink to this headline">¶</a></h2>
<p>A major goal of MTUQ is to avoid exposing users to unnecessary complexity. For Green’s functions, MTUQ tries to accomplish this by understanding external conventions and converting to a common internal format.  Specifically, MTUQ uses an <cite>up-south-east</cite> <a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.imaging.mopad_wrapper.beach.html#supported-basis-systems">convention</a> for internally storing impulse responses corresponding to  individual force couples. (Moment tensors and forces are internally represented using the same <cite>up-south-east</cite> basis.)</p>
<p>Under the hood, MTUQ deals with a variety of external conventions related to (1) the symmetry of the medium (for example, 1D media require fewer independent Green’s functions than 3D media); (2) the choice of local Cartesian basis convention (for example, some authors employ <cite>up-south-east</cite>, others <cite>north-east-down</cite>). A sense of what’s involved can be obtained by browsing the <a class="reference external" href="https://github.com/uafgeotools/mtuq/tree/master/mtuq/greens_tensor">source code</a> and references therein.</p>
</section>
<section id="downloading-precomputed-green-s-functions">
<h2>Downloading precomputed Green’s functions<a class="headerlink" href="#downloading-precomputed-green-s-functions" title="Permalink to this headline">¶</a></h2>
<p>An easy way to acquire Green’s functions is to download them from <a class="reference external" href="http://ds.iris.edu/ds/products/syngine/">syngine</a>, a web service that hosts Green’s functions from the following 1D Earth models: <cite>PREM</cite>, <cite>AK135</cite>, and <cite>iasp91</cite>.</p>
<p>To download AK135 Green’s functions and generate MTUQ <cite>GreensTensor</cite> objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mtuq</span> <span class="kn">import</span> <span class="n">download_greens_functions</span>
<span class="n">greens_tensors</span> <span class="o">=</span> <span class="n">download_greens_functions</span><span class="p">(</span><span class="n">stations</span><span class="p">,</span> <span class="n">origins</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ak135f_2s&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A limitation of syngine is that Green’s functions can be downloaded only on a station-by-station basis, not over an entire area or volume.  An alternative that avoids this limitation is to compute your own Green’s functions.</p>
</section>
<section id="computing-green-s-functions-from-1d-earth-models">
<h2>Computing Green’s functions from 1D Earth models<a class="headerlink" href="#computing-green-s-functions-from-1d-earth-models" title="Permalink to this headline">¶</a></h2>
<p>MTUQ supports the following 1D Green’s functions formats: AxiSEM (preferred), FK, and CPS.</p>
<p><a class="reference external" href="https://github.com/geodynamics/axisem">AxiSEM</a> performs spectral element wave simulations in radially-symmetric Earth models.  AxiSEM NetCDF files can be used to retrieve vertical, radial, and transverse  displacement in units of m*(N-m)^-1.</p>
<p>To generate AxiSEM synthetics in a format MTUQ supports, follow the instructions in the <a class="reference external" href="https://raw.githubusercontent.com/geodynamics/axisem/master/MANUAL/manual_axisem1.3.pdf">AxiSEM user manual</a>  under “Output wavefields in NetCDF format needed by instaseis.”</p>
<p>To open an AxiSEM database client in MTUQ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mtuq</span> <span class="kn">import</span> <span class="n">open_db</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">open_db</span><span class="p">(</span><span class="n">path_to_NetCDF_file</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;AxiSEM&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://www.eas.slu.edu/People/LZhu/home.html">FK</a> simulates wave propagation in horizontally-layered elastic media using a frequency-wavenumber integration method.   FK  simulations create SAC files in a directory tree organized by model, event depth, and event distance.  Each SAC file represents a vertical, radial, or transverse velocity time series in units of 10^-20*cm*(dyne-cm)^-1 s^-1.</p>
<p>To open an FK database client in MTUQ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mtuq</span> <span class="kn">import</span> <span class="n">open_db</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">open_db</span><span class="p">(</span><span class="n">path_to_FK_directory_tree</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;FK&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once opened, an AxiSEM or FK database client can be used to generate <a class="reference external" href="https://uafgeotools.github.io/mtuq/library/generated/mtuq.GreensTensor.html">GreensTensor</a> objects as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">greens_tensors</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_greens_tensors</span><span class="p">(</span><span class="n">stations</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="computing-green-s-functions-from-3d-earth-models">
<h2>Computing Green’s functions from 3D Earth models<a class="headerlink" href="#computing-green-s-functions-from-3d-earth-models" title="Permalink to this headline">¶</a></h2>
<p>MTUQ currently supports 3D Green’s functions from SPECFEM3D/3D_GLOBE.</p>
<p>To generate a full set of Green’s functions for a given hypocenter and depth, six SPECFEM3D/3D_GLOBE wavefield simulations are required.  Output must be saved as/converted to SAC files at individual stations using the following filename convention, which comes from <a class="reference external" href="https://github.com/UTCompSeismo/GRD_CMT3D/tree/master/cmt3d">GRD_CMT3D</a>.  Place all SAC files corresponding to a single hypocenter and depth in the same directory as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">event_id</span><span class="p">}</span><span class="o">/</span>
    <span class="p">{</span><span class="n">depth_in_km</span><span class="p">}</span><span class="o">/</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mrr</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mtt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mpp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mrt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mrp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">Mtp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mrr</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mtt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mpp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mrt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mrp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">Mtp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mrr</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mtt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mpp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mrt</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mrp</span><span class="o">.</span><span class="n">sac</span>
        <span class="p">{</span><span class="n">net</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">sta</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">loc</span><span class="p">}</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">Mtp</span><span class="o">.</span><span class="n">sac</span>
</pre></div>
</div>
<p>To open a SPECFEM3D/3D_GLOBE database client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mtuq</span> <span class="kn">import</span> <span class="n">open_db</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">open_db</span><span class="p">(</span><span class="n">path_SPECFEM3D_output_directory</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;SPECFEM3D&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once opened, the database client can be used to generate <a class="reference external" href="https://uafgeotools.github.io/mtuq/library/generated/mtuq.GreensTensor.html">GreensTensor</a> objects as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">greens_tensors</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_greens_tensors</span><span class="p">(</span><span class="n">stations</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information, see also:</p>
<p><a class="reference external" href="https://uafgeotools.github.io/mtuq/user_guide/03/source_side.html">Source-side Green’s function details (under construction)</a></p>
<p><a class="reference external" href="https://uafgeotools.github.io/mtuq/user_guide/03/receiver_side.html">Receiver-side Green’s function details (under construction)</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>